<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Vetmates - Tierarztpraxis Management</title>
    <link rel="stylesheet" href="app/styles/reset.css">
    <link rel="stylesheet" href="app/styles/variables.css">
    <link rel="stylesheet" href="app/styles/theme.css">
    <link rel="stylesheet" href="app/styles/typography.css">
    <link rel="stylesheet" href="app/styles/layout.css">
    <link rel="stylesheet" href="app/styles/utilities.css">
    <link rel="stylesheet" href="app/styles/pages/dashboard.css">
    <link rel="stylesheet" href="app/styles/components/navbar.css">
    <link rel="stylesheet" href="app/styles/components/sidebar.css">
    <link rel="stylesheet" href="app/styles/components/buttons.css">
    <link rel="stylesheet" href="app/styles/components/forms.css">
    <link rel="stylesheet" href="app/styles/components/cards.css">
    <link rel="stylesheet" href="app/styles/components/tables.css">
    <link rel="stylesheet" href="app/styles/components/alerts.css">
    <link rel="stylesheet" href="app/styles/components/badges.css">
</head>
<body>
    <!-- Include Navbar Component -->
    <div id="navbar-container"></div>
    
    <!-- Include Sidebar Component (dynamically loaded) -->
    <div id="sidebar-container"></div>

    <!-- Main Content -->
    <main class="main-content">
        <div class="page-container">
            <!-- Page Header -->
            <div class="page-header">
                <h1 class="page-title">Dashboard</h1>
                <p class="page-description">Willkommen in Ihrem Tierarztpraxis-Managementsystem. Verwalten Sie Ihre Patienten, Termine und medizinischen Aufzeichnungen an einem Ort.</p>
            </div>

            <!-- Stats Grid -->
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-value">24</div>
                    <div class="stat-label">Aktive Patienten</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value">18</div>
                    <div class="stat-label">Heutige Termine</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value">156</div>
                    <div class="stat-label">Abgeschlossene Behandlungen</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value">12</div>
                    <div class="stat-label">Verfügbares Personal</div>
                </div>
            </div>

            <!-- Dashboard Content -->
            <div class="dashboard-content">
                <!-- Main Content Area -->
                <div class="dashboard-main">
                    <!-- Quick Actions -->
                    <div class="quick-actions">
                        <h3>Schnellaktionen</h3>
                        <div class="action-buttons">
                            <a href="app/patienten/patienten.html" class="action-button">
                                <div class="icon">👤</div>
                                <span>Neuen Patienten hinzufügen</span>
                            </a>
                            <a href="app/kalender/kalender.html" class="action-button">
                                <div class="icon">🐕</div>
                                <span>Termin vereinbaren</span>
                            </a>
                            <a href="app/behandlungen/" class="action-button">
                                <div class="icon">📋</div>
                                <span>Behandlung erstellen</span>
                            </a>
                            <a href="app/inventuren/" class="action-button">
                                <div class="icon">💊</div>
                                <span>Inventar verwalten</span>
                            </a>
                        </div>
                    </div>

                    <!-- Recent Activity -->
                    <div class="recent-activity">
                        <h3>Letzte Aktivitäten</h3>
                        <div class="activity-list">
                            <div class="activity-item">
                                <div class="activity-icon driver">👤</div>
                                <div class="activity-content">
                                    <div class="activity-title">Neuer Patient registriert: Max der Golden Retriever</div>
                                    <div class="activity-time">vor 2 Stunden</div>
                                </div>
                            </div>
                            <div class="activity-item">
                                <div class="activity-icon vehicle">🐕</div>
                                <div class="activity-content">
                                    <div class="activity-title">Termin abgeschlossen: Bella die Katze - Impfung</div>
                                    <div class="activity-time">vor 4 Stunden</div>
                                </div>
                            </div>
                            <div class="activity-item">
                                <div class="activity-icon trip">📋</div>
                                <div class="activity-content">
                                    <div class="activity-title">Behandlung abgeschlossen: Operation bei Rocky dem Bulldog</div>
                                    <div class="activity-time">vor 6 Stunden</div>
                                </div>
                            </div>
                            <div class="activity-item">
                                <div class="activity-icon driver">👤</div>
                                <div class="activity-content">
                                    <div class="activity-title">Patientenstatus aktualisiert: Luna der Husky</div>
                                    <div class="activity-time">vor 8 Stunden</div>
                                </div>
                            </div>
                            <div class="activity-item">
                                <div class="activity-icon vehicle">🐕</div>
                                <div class="activity-content">
                                    <div class="activity-title">Neuer Termin vereinbart: Charlie der Pudel</div>
                                    <div class="activity-time">vor 1 Tag</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Sidebar Content -->
                <div class="dashboard-sidebar">
                    <!-- Practice Overview -->
                    <div class="card">
                        <div class="card-header">
                            <h4 class="card-title">Praxis-Übersicht</h4>
                        </div>
                        <div class="card-body">
                            <div style="margin-bottom: var(--space-4);">
                                <div style="display: flex; justify-content: space-between; margin-bottom: var(--space-2);">
                                    <span style="font-size: 0.875rem; color: var(--text-secondary);">Gesamt Patienten</span>
                                    <span style="font-weight: var(--font-weight-semibold);">24</span>
                                </div>
                                <div style="display: flex; justify-content: space-between; margin-bottom: var(--space-2);">
                                    <span style="font-size: 0.875rem; color: var(--text-secondary);">In Behandlung</span>
                                    <span style="font-weight: var(--font-weight-semibold); color: var(--success);">18</span>
                                </div>
                                <div style="display: flex; justify-content: space-between; margin-bottom: var(--space-2);">
                                    <span style="font-size: 0.875rem; color: var(--text-secondary);">Geplant</span>
                                    <span style="font-weight: var(--font-weight-semibold); color: var(--warning);">4</span>
                                </div>
                                <div style="display: flex; justify-content: space-between;">
                                    <span style="font-size: 0.875rem; color: var(--text-secondary);">Genesung</span>
                                    <span style="font-weight: var(--font-weight-semibold); color: var(--error);">2</span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Quick Stats -->
                    <div class="card">
                        <div class="card-header">
                            <h4 class="card-title">Diesen Monat</h4>
                        </div>
                        <div class="card-body">
                            <div style="margin-bottom: var(--space-4);">
                                <div style="display: flex; justify-content: space-between; margin-bottom: var(--space-2);">
                                    <span style="font-size: 0.875rem; color: var(--text-secondary);">Gesamt Termine</span>
                                    <span style="font-weight: var(--font-weight-semibold);">156</span>
                                </div>
                                <div style="display: flex; justify-content: space-between; margin-bottom: var(--space-2);">
                                    <span style="font-size: 0.875rem; color: var(--text-secondary);">Behandlungen</span>
                                    <span style="font-weight: var(--font-weight-semibold);">89</span>
                                </div>
                                <div style="display: flex; justify-content: space-between; margin-bottom: var(--space-2);">
                                    <span style="font-size: 0.875rem; color: var(--text-secondary);">Operationen</span>
                                    <span style="font-weight: var(--font-weight-semibold);">12</span>
                                </div>
                                <div style="display: flex; justify-content: space-between;">
                                    <span style="font-size: 0.875rem; color: var(--text-secondary);">Erfolgsrate</span>
                                    <span style="font-weight: var(--font-weight-semibold); color: var(--success);">94%</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- Load Navbar HTML -->
    <script>
        // Load navbar HTML
        fetch('app/components/navbar/navbar.html')
            .then(response => response.text())
            .then(html => {
                // Fix the Vetmates link for the current page location
                const fixedHtml = html.replace(/href="#" class="brand-link"/g, 'href="index.html" class="brand-link"');
                
                document.getElementById('navbar-container').innerHTML = fixedHtml;
                
                // Initialize navbar after HTML is loaded
                if (window.Navbar) {
                    window.navbar = new window.Navbar();
                } else {
                    // If Navbar class is not available yet, wait for it
                    const checkNavbar = setInterval(() => {
                        if (window.Navbar) {
                            window.navbar = new window.Navbar();
                            clearInterval(checkNavbar);
                        }
                    }, 100);
                }
            })
            .catch(error => {
                console.error('Error loading navbar:', error);
            });
    </script>
    
    <!-- Load Navbar JS -->
    <script src="app/components/navbar/navbar.js"></script>
    
    <!-- Load Sidebar HTML -->
    <script>
        // Load sidebar HTML
        fetch('app/components/sidebar/sidebar.html')
            .then(response => response.text())
            .then(html => {
                document.getElementById('sidebar-container').innerHTML = html;
                
                // Initialize sidebar after HTML is loaded
                if (window.Sidebar) {
                    window.sidebar = new window.Sidebar();
                } else {
                    // If Sidebar class is not available yet, wait for it
                    const checkSidebar = setInterval(() => {
                        if (window.Sidebar) {
                            window.sidebar = new window.Sidebar();
                            clearInterval(checkSidebar);
                        }
                    }, 100);
                }
            })
            .catch(error => {
                console.error('Error loading sidebar:', error);
            });
    </script>
    
    <!-- Load Sidebar JS -->
    <script src="app/components/sidebar/sidebar.js"></script>
    
    <!-- Load Authentication System -->
    <script src="login/config.js"></script>
    <script type="module" src="login/auth.js"></script>
    
    <!-- Initialize Authentication for Main App -->
    <script type="module">
        // Wait for auth manager to be available
        document.addEventListener('DOMContentLoaded', async () => {
            while (!window.authManager) {
                await new Promise(resolve => setTimeout(resolve, 100))
            }

            // Check if user is authenticated
            const isAuthenticated = await window.authManager.requireAuth()
            
            if (!isAuthenticated) {
                // User will be redirected to login by requireAuth()
                return
            }

            // User is authenticated, continue with app initialization
            console.log('User authenticated, dashboard ready');
        });
    </script>
    
    <!-- Load Main App JS -->
    <script src="app/index.js"></script>
</body>
</html> 